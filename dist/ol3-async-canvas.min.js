ol.source.ImageCanvasAsync=function(a){ol.source.Image.call(this,{attributions:a.attributions,logo:a.logo,projection:a.projection,resolutions:a.resolutions,state:a.state}),this.canvasFunction_=a.canvasFunction,this.canvasElement_=a.canvasElement,this.canvas_=null,this.renderedRevision_=0,this.ratio_=void 0!==a.ratio?a.ratio:1.5},ol.inherits(ol.source.ImageCanvasAsync,ol.source.Image),ol.source.ImageCanvasAsync.prototype.getImageInternal=function(a,b,c,d){if(b=this.findNearestResolution(b),this.canvas_&&this.renderedRevision_==this.getRevision()&&this.canvas_.getResolution()==b&&this.canvas_.getPixelRatio()==c&&ol.extent.containsExtent(this.canvas_.getExtent(),a))return this.canvas_;a=a.slice(),ol.extent.scaleFromCenter(a,this.ratio_);var e=ol.extent.getWidth(a)/b,f=ol.extent.getHeight(a)/b,g=[e*c,f*c];return this.canvas_=new ol.ImageCanvas(a,b,c,this.getAttributions(),this.canvasElement_,this.canvasFunction_.bind(this,a,b,c,g,d)),this.renderedRevision_=this.getRevision(),ol.events.listen(this.canvas_,ol.events.EventType.CHANGE,this.handleImageChange,this),this.canvas_};