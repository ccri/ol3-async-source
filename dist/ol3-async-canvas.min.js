ol.source.ImageCanvasAsync=function(a){ol.source.Image.call(this,{attributions:a.attributions,logo:a.logo,projection:a.projection,resolutions:a.resolutions,state:a.state}),this.canvasFunction_=a.canvasFunction,this.canvasElement_=a.canvasElement,this.canvas_=null,this.renderedRevision_=0,this.ratio_=void 0!==a.ratio?a.ratio:1.5},ol.inherits(ol.source.ImageCanvasAsync,ol.source.Image),ol.source.ImageCanvasAsync.prototype.getImageInternal=function(a,b,c,d){b=this.findNearestResolution(b);var e=this.canvas_;if(e&&this.renderedRevision_==this.getRevision()&&e.getResolution()==b&&e.getPixelRatio()==c&&ol.extent.containsExtent(e.getExtent(),a))return e;a=a.slice(),ol.extent.scaleFromCenter(a,this.ratio_);var f=ol.extent.getWidth(a)/b,g=ol.extent.getHeight(a)/b,h=[f*c,g*c];return this.canvas_=new ol.ImageCanvas(a,b,c,this.getAttributions(),this.canvasElement_,this.canvasFunction_.bind(this,a,b,c,h,d)),this.renderedRevision_=this.getRevision(),ol.events.listen(this.canvas_,ol.events.EventType.CHANGE,this.handleImageChange,this),e};